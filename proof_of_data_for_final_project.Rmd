---
title: "Final_css_205"
author: "Reeka Estacio And Belynda Herrera"
date: "2025-02-11"
output:
  word_document: default
  pdf_document: default
---

```{r setup, include=FALSE}
rm(list = ls())
knitr::opts_chunk$set(echo = TRUE)
library(readr)
library(ggplot2)
library(dplyr)
library(haven)
```
Load the data for your replication project into R.  Produce the following:
```{r}



# Read .dta file
data <- read_dta("Downloads/Cleaned Data.dta")

# Save as CSV
write.csv(data, "Downloads/Cleaned Data.dta", row.names = FALSE)
```

A histogram of the dependent variable

```{r cars}
ggplot(data, aes(x = femindexa)) + 
  geom_histogram(bins = 30, fill = "blue", color = "black") +
  labs(title = "Histogram of Modern Sexism",
       x = "Modern Sexism Score",
       y = "Frequency") +
  theme_minimal()
```

## Including Plots
```{r}
# Select  columns
subset_data <- data[, c("femindexa", "sex", "lrself", "voteintentionspain", "femstrike")]

# Removing rows with any missing data for simplicity
clean_data <- na.omit(subset_data)

# Convert categorical variables to numeric
clean_data$sex <- as.numeric(as.factor(clean_data$sex))
clean_data$voteintentionspain <- as.numeric(as.factor(clean_data$voteintentionspain)) 

# Calculate the correlation matrix
cor_matrix <- cor(clean_data)

# Load the library
library(corrplot)


# Plot the correlation matrix
corrplot(cor_matrix, method = "color", type = "upper", tl.cex = 0.7, 
         tl.col = "black", addCoef.col = "black", number.cex = 0.7)

```

```{r}
install.packages("mice", repos = "http://cran.rstudio.com")

# Select relevant columns
subset_data <- data[, c("femindexa", "sex", "lrself", "voteintentionspain", "femstrike")]

# Generate a missingness pattern table
md.pattern(subset_data)


```
Visual Representation of Missing Data

A missingness map highlights missing values in the dataset.
```{r}
# Load the Amelia package
library(Amelia)

# Generate a missingness map
missmap(subset_data, col = c("blue", "red"), legend = TRUE)

```

Proportion of Missing Data
A bar plot showing the proportion of missing values per variable.

```{r}
# Load VIM library
library(VIM)

# Bar plot of missing data proportions
aggr(subset_data, col = c("navyblue", "red"), numbers = TRUE, sortVars = TRUE, 
     labels = names(subset_data), cex.axis = 0.7, gap = 2, 
     ylab = c("Missing Data Pattern", "Proportion of Missingness"))

```

An aggregation plot displays missing data in different variable combinations
```{r}
matrixplot(subset_data, sortby = "femindexa", col = c("grey", "black"))

```

